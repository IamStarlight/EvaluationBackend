<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http#{//mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.example.evaluation.mapper.WorkMapper">

    <select id="getAllWorkInfoBySid" resultType="com.example.evaluation.controller.dto.HomeworkInfo">
        SELECT wid,cname,title,details,start_time,end_time,status,url,submit_number
        FROM homework,sc,course
        WHERE sc.sid=#{sid}
        AND homework.cid=sc.cid
        AND homework.cid=course.cid;
    </select>

    <select id="getAllWorkInfoByCid" resultType="com.example.evaluation.controller.dto.HomeworkInfo">
        SELECT wid,cname,title,details,start_time,end_time,status,url,submit_number,status
        FROM homework,course
        WHERE homework.cid=course.cid
        AND homework.cid=#{cid}
    </select>

    <select id="getWorkInfoById" resultType="com.example.evaluation.controller.dto.HomeworkInfo">
        select wid,cname,title,details,end_time,submit_number,class_number,status
        from homework,course
        where homework.cid=course.cid
        and homework.cid=#{cid}
        and wid=#{wid}
    </select>

    <insert id="createNewWork">
        insert into homework(wid,cid,title,details,start_time,end_time,status,url)
        values (#{wid},#{cid},#{title},#{details},#{startTime},#{endTime},#{status},#{url})
    </insert>

    <update id="updateStatus">
        update homework
        set status=#{status}
        where wid=#{wid}
        and cid=#{cid}
    </update>

    <select id="getAllWorkInfoByTid" resultType="com.example.evaluation.controller.dto.HomeworkInfo">
        SELECT wid,cname,title,details,start_time,end_time,status,url,submit_number
        FROM homework,course
        WHERE course.tid=#{tid}
        AND homework.cid=course.cid;
    </select>

    <select id="getStuWorkInfo" resultType="com.example.evaluation.controller.dto.HomeworkInfo">
        select wid,cname,title,details,end_time,status
        from homework,course,sc
        where sc.sid=#{sid}
        and homework.cid=sc.cid
        and homework.cid=course.cid
        and homework.cid=#{cid}
    </select>
</mapper>
