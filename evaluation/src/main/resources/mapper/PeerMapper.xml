<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http#{//mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.example.evaluation.mapper.PeerMapper">

    <update id="peerEvaluation">
        update peer_evaluation
        set grade=#{grade},comments=#{comments}
        where eva_sid=#{evaSid}
        and sid=#{sid}
        and wid=#{wid}
        and cid=#{cid}
    </update>

    <insert id="addEvaluation">
        insert into peer_evaluation
        values (#{evaSid},#{sid},#{wid},#{cid},#{grade},#{comments})
    </insert>

    <select id="selectAllWork">
        select * from stu_homework
        where wid=#{wid}
        and sid in(
        select sid from peer_evaluation
        where evaSId=#{evaSId}
        and cid=#{cid})
    </select>

    <select id="selectForTeacher">
        select * from peer_evaluation
        where evaSid=#{evaSid}
        and wid=#{wid}
    </select>

    <select id="selectForStudent">
        select * from peer_evaluation
        where sid=#{sid}
        and cid=#{cid}
        and wid=#{wid}
    </select>

    <select id="selectOneWork">
        select * from stu_homework
        where sid=#{sid}
        and cid=#{cid}
        and wid=#{wid}
    </select>
</mapper>
